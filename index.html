<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MOMO Group — Parody Momentum Homepage</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- TradingView Widget -->
  <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
  <style>
    html { color-scheme: dark; }
    body { background: radial-gradient(circle at 50% 0%, rgba(255,255,255,0.06), transparent 45%), linear-gradient(135deg, #0a0b12, #0b0f1d, #090a0f); }
    .ticker { overflow: hidden; white-space: nowrap; position: relative; }
    .ticker-track { display: inline-flex; animation: ticker 30s linear infinite; }
    @keyframes ticker { from { transform: translateX(0); } to { transform: translateX(-50%); } }
    .suggestion-item:hover { background: rgba(255,255,255,0.06); }
  </style>
</head>
<body class="min-h-screen text-white">
  <!-- Glow blobs -->
  <div class="pointer-events-none fixed -z-10 inset-0">
    <div class="absolute -left-32 -top-24 h-72 w-72 rounded-full bg-fuchsia-500/20 blur-3xl"></div>
    <div class="absolute -right-40 top-1/4 h-80 w-80 rounded-full bg-cyan-500/20 blur-3xl"></div>
    <div class="absolute bottom-10 left-1/3 h-64 w-64 rounded-full bg-indigo-500/20 blur-3xl"></div>
  </div>

  <!-- Header -->
  <header class="mx-auto flex max-w-7xl items-center justify-between px-6 py-5">
    <div class="flex items-center gap-3">
      <div class="grid h-9 w-9 place-items-center rounded-xl bg-white/10 shadow-inner">📈</div>
      <h1 class="text-lg font-bold tracking-wider">MOMO Group — Riding Waves Since Forever</h1>
    </div>
  </header>

  <!-- Hero -->
  <section class="mx-auto max-w-7xl px-6 pb-6 pt-4 text-center">
    <h2 class="text-5xl font-extrabold mb-4">Catch the Wave Before It Crashes 🌊</h2>
    <p class="max-w-2xl mx-auto text-white/70">
      Momentum trading isn’t just a strategy—it’s a lifestyle. We chase green candles, celebrate fakeouts,
      and pretend to meditate when red days hit. MOMO Group is your temple of trend worship.
    </p>
    <div class="mt-6">
      <button class="rounded-2xl px-6 py-3 text-base bg-fuchsia-600 hover:bg-fuchsia-500 transition">Join the Cult</button>
    </div>
  </section>

  <!-- Search + Add Symbol -->
  <section class="mx-auto max-w-7xl px-6">
    <div class="rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-4">
      <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
        <div class="w-full md:max-w-lg relative">
          <input id="symbolSearch" type="text" placeholder="Search ticker (e.g., AAPL, TSLA, NVDA)"
            class="w-full rounded-xl border border-white/10 bg-black/30 px-4 py-3 text-sm outline-none focus:ring-2 focus:ring-fuchsia-400" />
          <div id="searchSuggestions" class="absolute left-0 right-0 top-[110%] z-10 hidden rounded-xl border border-white/10 bg-[#111319] shadow-xl"></div>
        </div>
        <p class="text-sm text-white/60">Tip: Click a result to add it to the scrolling ticker ⟶</p>
      </div>
    </div>
  </section>

  <!-- Ticker -->
  <section class="mx-auto max-w-7xl px-6 mt-4">
    <div class="ticker rounded-xl border border-white/10 bg-white/5 backdrop-blur">
      <div id="tickerTrack" class="ticker-track py-3"></div>
    </div>
  </section>

  <!-- Live S&P 500 (TradingView) -->
  <section class="mx-auto max-w-7xl px-6 py-10">
    <div class="rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-4">
      <div class="flex items-center gap-2 text-xl font-semibold mb-1">📊 S&P 500 — Live</div>
      <p class="text-white/60 mb-3">Powered by TradingView widget. Interactive, real data.</p>
      <div id="spxWidget" class="h-[420px] w-full"></div>
    </div>
  </section>

  <!-- Live Feeds: Twitter + Reddit -->
  <section class="mx-auto max-w-7xl px-6 py-8 grid gap-6 md:grid-cols-3">
    <!-- Twitter timeline + profile actions -->
    <div class="rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-4 md:col-span-1">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg font-semibold">🌀 Breaking Momentum: Tweets That Move Markets (Or At Least Our Moods)</h3>
        <!-- Follow button widget -->
        <a href="https://twitter.com/DeItaone" class="twitter-follow-button" data-size="large" data-show-count="true">Follow @DeItaone</a>
      </div>
      <!-- Mention button widget -->
      <div class="mb-3">
        <a href="https://twitter.com/intent/tweet?screen_name=DeItaone" class="twitter-mention-button" data-size="large">Tweet to @DeItaone</a>
      </div>
      <!-- Featured Tweet -->
      <div class="mb-4">
        <p class="text-sm text-white/60 mb-2">Featured Tweet</p>
        <blockquote class="twitter-tweet">
          <p lang="en" dir="ltr">*NVIDIA IS AMONG EQUITY INVESTORS IN MUSK&#39;S XAI CHIP DEAL<br><br>*MUSK’S XAI NEARS $20 BILLION CAPITAL RAISE TIED TO NVIDIA CHIPS</p>
          — *Walter Bloomberg (@DeItaone) <a href="https://twitter.com/DeItaone/status/1975701954182386148?ref_src=twsrc%5Etfw">October 7, 2025</a>
        </blockquote>
      </div>

      <!-- Latest Tweet (auto-refresh daily) -->
      <div class="mb-4">
        <p class="text-sm text-white/60 mb-2">Latest from @DeItaone</p>
        <div id="latestTweet" class="rounded-xl overflow-hidden"></div>
      </div>
      <!-- Timeline widget -->
      <a class="twitter-timeline" data-theme="dark" data-height="360" href="https://twitter.com/DeItaone?ref_src=twsrc%5Etfw">Tweets by @DeItaone</a>
      <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    </div>

    <!-- Reddit cards via JSON API (no iframe) -->
    <div class="rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-4 md:col-span-2">
      <h3 class="text-lg font-semibold mb-2">💥 r/wallstreetbets — The Momentum Oracle (Sometimes Drunk, Always Loud)</h3>
      <div id="redditGrid" class="grid gap-4 sm:grid-cols-2"></div>
      <p id="redditError" class="hidden mt-2 text-sm text-rose-300">Couldn’t load Reddit posts right now.</p>
    </div>
  </section>

  <!-- Feature Grid (Parody) -->
  <section class="mx-auto max-w-6xl px-6 py-10 grid gap-6 md:grid-cols-3">
    <div class="rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-6">
      <div class="mb-2 inline-flex rounded-lg bg-white/10 p-2">⚡</div>
      <h3 class="text-lg font-bold">Laser Focus (Until Lunch)</h3>
      <p class="text-white/70">Scan, plan, then immediately forget the plan.</p>
    </div>
    <div class="rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-6">
      <div class="mb-2 inline-flex rounded-lg bg-white/10 p-2">🚀</div>
      <h3 class="text-lg font-bold">To The Moon‑ish</h3>
      <p class="text-white/70">Sometimes it goes up. Sometimes we cope together.</p>
    </div>
    <div class="rounded-2xl border border-white/10 bg-white/5 backdrop-blur-xl p-6">
      <div class="mb-2 inline-flex rounded-lg bg-white/10 p-2">🛡️</div>
      <h3 class="text-lg font-bold">Risk? Never Heard of Her</h3>
      <p class="text-white/70">Emotional stop‑loss only.</p>
    </div>
  </section>

  <!-- Vibes not Tiers -->
  <section class="mx-auto max-w-6xl px-6 py-12 text-center">
    <h3 class="text-2xl font-bold mb-4">We Don’t Sell Tiers — Just Vibes</h3>
    <p class="text-white/70 max-w-2xl mx-auto">
      Forget pricing plans. If you’re reading this, you’re already emotionally invested.
      All we ask is your attention span and maybe a follow on social media.
    </p>
  </section>

  <!-- Footer -->
  <footer class="border-t border-white/10 py-8 text-center text-sm text-white/60">
    © <span id="year"></span> Momo Group of Companies — Making FOMO Profitable Since 2025 🚀
  </footer>

  <script>
    // === Config ===
    const FMP_API_KEY = "cFYu9d14o2eSBi3nP6M7M1KkbewtdfLP"; // already set
    // Symbols to fetch (q = query symbol for API, d = display label)
    let SYMBOLS = [
      { q: 'POET', d: 'POET', type: 'equity' },
      { q: 'INTC', d: 'INTC', type: 'equity' },
      { q: 'BMRN', d: 'BMRN', type: 'equity' },
      { q: 'OPEN', d: 'OPEN', type: 'equity' },
      { q: 'RDDT', d: 'RDDT', type: 'equity' },
      { q: 'VKTX', d: 'VKTX', type: 'equity' },
      { q: 'BTCUSD', d: 'BTC', type: 'crypto' }, // crypto uses a different endpoint
    ];

    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Render a price chip
    function renderChip({ symbol, price, change }) {
      const chip = document.createElement('div');
      chip.className = 'mx-6 flex items-center gap-2 rounded-full border border-white/10 px-4 py-1 text-sm backdrop-blur bg-black/20';
      const sym = document.createElement('span'); sym.className = 'font-bold text-fuchsia-300'; sym.textContent = symbol;
      const pr = document.createElement('span'); pr.className = 'opacity-70'; pr.textContent = Number(price).toFixed(2);
      const chg = document.createElement('span'); chg.className = 'font-semibold ' + (change >= 0 ? 'text-emerald-400' : 'text-rose-400'); chg.textContent = (change >= 0 ? '+' : '') + Number(change).toFixed(2);
      chip.appendChild(sym); chip.appendChild(pr); chip.appendChild(chg);
      return chip;
    }

    // Update ticker DOM with data array [{symbol, price, change}]
    function updateTicker(quotes) {
      const track = document.getElementById('tickerTrack');
      track.innerHTML = '';
      const items = quotes.map(q => renderChip(q));
      [...items, ...items].forEach(el => track.appendChild(el.cloneNode(true))); // duplicate for seamless scroll
    }

    // Fallback demo data if no key
    function demoQuotes() {
      return [
        { symbol: 'POET', price: 2.94, change: 0.12 },
        { symbol: 'INTC', price: 39.48, change: -0.22 },
        { symbol: 'BMRN', price: 92.11, change: 0.31 },
        { symbol: 'OPEN', price: 4.36, change: 0.14 },
        { symbol: 'RDDT', price: 57.83, change: 0.21 },
        { symbol: 'VKTX', price: 74.55, change: 0.88 },
        { symbol: 'BTC', price: 62845.72, change: -120.44 },
      ];
    }

    async function fetchFmpQuotes() {
      if (!FMP_API_KEY) { updateTicker(demoQuotes()); return; }

      const equities = SYMBOLS.filter(s => s.type !== 'crypto').map(s => s.q.toUpperCase());
      const cryptos  = SYMBOLS.filter(s => s.type === 'crypto').map(s => s.q.toUpperCase());

      try {
        const tasks = [];
        if (equities.length) {
          const eqUrl = `https://financialmodelingprep.com/stable/quote-short/${equities.join(',')}?apikey=${FMP_API_KEY}&_=${Date.now()}`;
          tasks.push(fetch(eqUrl, { cache: 'no-store', headers: { 'Cache-Control': 'no-cache' } }).then(r => r.json()).then(arr => ({ kind: 'eq', arr })));
        }
        if (cryptos.length) {
          const crUrl = `https://financialmodelingprep.com/stable/batch-crypto-quotes?symbol=${cryptos.join(',')}&apikey=${FMP_API_KEY}&_=${Date.now()}`;
          tasks.push(fetch(crUrl, { cache: 'no-store', headers: { 'Cache-Control': 'no-cache' } }).then(r => r.json()).then(arr => ({ kind: 'cr', arr })));
        }

        const results = await Promise.all(tasks);

        const map = new Map();
        for (const res of results) {
          if (res.kind === 'eq' && Array.isArray(res.arr)) {
            for (const r of res.arr) {
              // quote-short returns { symbol, price, volume }
              map.set(r.symbol?.toUpperCase(), { price: r.price, change: 0 });
            }
          } else if (res.kind === 'cr' && Array.isArray(res.arr?.data)) {
            for (const r of res.arr.data) {
              // batch-crypto-quotes returns {symbol, price, changesPercentage}
              map.set(r.symbol?.toUpperCase(), { price: r.price, change: r.changesPercentage ?? 0 });
            }
          }
        }

        const quotes = SYMBOLS.map(({ q, d }) => {
          const rec = map.get(q.toUpperCase()) || {};
          return { symbol: d, price: rec.price ?? 0, change: typeof rec.change === 'number' ? rec.change : 0 };
        });
        updateTicker(quotes);
      } catch (e) {
        console.error('FMP fetch error', e);
        updateTicker(demoQuotes());
      }
    }

    // === Search / Autocomplete ===
    const searchInput = document.getElementById('symbolSearch');
    const suggestions = document.getElementById('searchSuggestions');

    function debounce(fn, ms) {
      let t; return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), ms); };
    }

    async function searchSymbols(q) {
      if (!q || q.length < 1) { suggestions.classList.add('hidden'); suggestions.innerHTML = ''; return; }
      const url = `https://financialmodelingprep.com/stable/search-symbol?query=${encodeURIComponent(q)}&apikey=${FMP_API_KEY}`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        renderSuggestions(Array.isArray(data) ? data.slice(0, 8) : []);
      } catch (e) {
        console.error('search error', e);
        renderSuggestions([]);
      }
    }

    function renderSuggestions(list) {
      if (!list.length) { suggestions.classList.add('hidden'); suggestions.innerHTML=''; return; }
      suggestions.innerHTML = list.map(i => (
        `<div class="suggestion-item px-3 py-2 text-sm cursor-pointer" data-symbol="${i.symbol}"><span class="font-semibold">${i.symbol}</span> <span class="text-white/50">${i.name || ''}</span></div>`
      )).join('');
      suggestions.classList.remove('hidden');
    }

    suggestions.addEventListener('click', (e) => {
      const target = e.target.closest('[data-symbol]');
      if (!target) return;
      const sym = target.getAttribute('data-symbol');
      addSymbol(sym);
      suggestions.classList.add('hidden');
      searchInput.value = '';
    });

    const debouncedSearch = debounce((ev) => searchSymbols(ev.target.value.trim().toUpperCase()), 250);
    searchInput.addEventListener('input', debouncedSearch);
    document.addEventListener('click', (e) => { if (!e.target.closest('#searchSuggestions') && !e.target.closest('#symbolSearch')) suggestions.classList.add('hidden'); });

    function addSymbol(sym) {
      if (!sym) return;
      const up = sym.toUpperCase();
      const exists = SYMBOLS.some(s => s.q.toUpperCase() === up);
      if (exists) return;
      const type = up.includes('USD') || up.startsWith('BTC') || up.startsWith('ETH') ? 'crypto' : 'equity';
      SYMBOLS.push({ q: up, d: up.replace('USD',''), type });
      fetchFmpQuotes();
    }

    // Initial render + poll every 10s
    fetchFmpQuotes();
    setInterval(fetchFmpQuotes, 10000);

    // === Reddit JSON widgets (no iframes) ===
    const REDDIT_POSTS = [
      'https://www.reddit.com/r/wallstreetbets/comments/1nqjmwv/750k_in_nbis_nezuko_body_pillow_formation_150_pt/',
      'https://www.reddit.com/r/wallstreetbets/comments/1kmaqin/opendoor_is_the_next_carvana/',
      'https://www.reddit.com/r/wallstreetbets/comments/1m6eifr/my_biggest_gain_ever_sold_duh/',
      'https://www.reddit.com/r/wallstreetbets/comments/1m8hge6/finally_broke_even_400k_50k_500k/',
    ];

    function redditJsonUrl(permalink) {
      // ensure trailing slash and add .json
      const u = permalink.endsWith('/') ? permalink : permalink + '/';
      return u + '.json';
    }

    function formatNumber(n){
      if (n >= 1e6) return (n/1e6).toFixed(1)+'M';
      if (n >= 1e3) return (n/1e3).toFixed(1)+'k';
      return String(n);
    }

    async function fetchRedditPosts() {
      const grid = document.getElementById('redditGrid');
      const err = document.getElementById('redditError');
      grid.innerHTML = '';
      err.classList.add('hidden');

      try {
        const promises = REDDIT_POSTS.map(async (url) => {
          const res = await fetch(redditJsonUrl(url), { cache: 'no-store' });
          const data = await res.json();
          const post = data?.[0]?.data?.children?.[0]?.data;
          if (!post) throw new Error('No post data');
          const title = post.title || 'Reddit Post';
          const score = post.score ?? 0;
          const comments = post.num_comments ?? 0;
          const author = post.author ? 'u/'+post.author : 'reddit';
          const dest = 'https://www.reddit.com' + (post.permalink || '');
          const thumb = (post.thumbnail && post.thumbnail.startsWith('http')) ? post.thumbnail : null;

          const card = document.createElement('a');
          card.href = dest; card.target = '_blank'; card.rel = 'noopener';
          card.className = 'rounded-xl border border-white/10 bg-black/30 p-4 hover:bg-white/5 transition block';
          card.innerHTML = `
            <div class="flex items-start gap-3">
              ${thumb ? `<img src="${thumb}" alt="thumb" class="h-14 w-14 rounded-md object-cover">` : `<div class="h-14 w-14 rounded-md bg-white/10 grid place-items-center">🧾</div>`}
              <div class="flex-1">
                <h4 class="font-semibold mb-1 text-fuchsia-300">${title}</h4>
                <p class="text-xs text-white/60">${author} • <span title="upvotes">▲ ${formatNumber(score)}</span> • <span title="comments">💬 ${formatNumber(comments)}</span></p>
              </div>
            </div>`;
          grid.appendChild(card);
        });
        await Promise.all(promises);
      } catch (e) {
        console.error('Reddit load error', e);
        err.classList.remove('hidden');
      }
    }

    // Load now and refresh every 5 minutes
    fetchRedditPosts();
    setInterval(fetchRedditPosts, 5 * 60 * 1000);

    // === Twitter latest-tweet widget (auto-refresh daily) ===
    function renderLatestTweet(){
      const host = document.getElementById('latestTweet');
      if (!host) return;
      // Clear and inject a standard anchor-based timeline (more reliable than createTimeline in some embeds)
      host.innerHTML = '';
      const a = document.createElement('a');
      a.setAttribute('class','twitter-timeline');
      a.setAttribute('data-theme','dark');
      a.setAttribute('data-tweet-limit','1');
      a.setAttribute('data-chrome','noheader nofooter noborders transparent');
      a.setAttribute('href','https://twitter.com/DeItaone');
      a.textContent = 'Latest from @DeItaone';
      host.appendChild(a);
      // If widgets.js is ready, (re)parse only inside host; else retry shortly
      const loadWidgets = () => {
        if (window.twttr && window.twttr.widgets && typeof window.twttr.widgets.load === 'function') {
          window.twttr.widgets.load(host);
        } else {
          setTimeout(loadWidgets, 800);
        }
      };
      loadWidgets();
    }
    renderLatestTweet();
    // Refresh once per day
    setInterval(renderLatestTweet, 24 * 60 * 60 * 1000);

    // --- Basic console tests (non-intrusive) ---
    (function runMomoTests(){
      try {
        console.group('%cMOMO self-tests','color:#a78bfa');
        console.assert(typeof fetchFmpQuotes === 'function', 'fetchFmpQuotes should be a function');
        const before = SYMBOLS.length;
        addSymbol('AAPL');
        console.assert(SYMBOLS.length === before + 1, 'addSymbol should add new symbol once');
        addSymbol('AAPL');
        console.assert(SYMBOLS.length === before + 1, 'addSymbol should not add duplicates');
        console.assert(SYMBOLS.some(s=>s.q==='AAPL'), 'AAPL should exist after add');
        console.groupEnd();
      } catch(e) { console.error('Self-tests failed:', e); }
    })();

    // TradingView NASDAQ widget
    if (window.TradingView) {
      new TradingView.widget({
        container_id: 'spxWidget',
        symbol: 'SP:SPX',
        interval: '1',
        timezone: 'America/New_York',
        theme: 'dark',
        style: '1',
        locale: 'en',
        toolbar_bg: 'rgba(0,0,0,0)',
        hide_side_toolbar: false,
        allow_symbol_change: false,
        calendar: false,
        autosize: true,
        studies: []
      });
    }
  </script>
</body>
</html>
